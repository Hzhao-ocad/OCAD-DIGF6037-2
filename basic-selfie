//This part of the code is for the selfie camera for phone pets. This hasn't been integrated with the other code yet so it is just a basic version of the functionality.

// Reference:
// https://editor.p5js.org/EthanHermsey/sketches/yjqWDF5FA
// Used this example as a reference for how to save still images from a video and display them. This example was used more in an animation context so I changed it so rather than appearing as one-at-a-time image frames, it can display each still image onto the page as the photos are taken.

let liveCamera; // video capture
let selfieCapture = []; //array to hold images in
let button; // button to take photos

let cameraWidth = 320;
let cameraHeight = 240;

function setup() {
  createCanvas(1000, 500); // (change in our final code)

  // this piece is from the referenced example, creating a constraint object for the video capture
  let videoConstraints = {
    video: {
      mandatory: {
        maxWidth: cameraWidth,
        maxHeight: cameraHeight,
      },
    },
    audio: false,
  };

  liveCamera = createCapture(videoConstraints); // create video capture based on the constraints
  liveCamera.position(10, 250); //position the camera (change these values when added to full project code)

  button = createButton("Take Selfie");
  button.mousePressed(takeSelfie);
}

function takeSelfie() {
  if (liveCamera.loadedmetadata) {
    // only shoot pics if the camera is ready (from referenced code)

    let img = liveCamera.get(0, 0, cameraWidth, cameraHeight); //get stills from the live camera feed
    selfieCapture.push(img); // push each captured frame into the array to be saved
  }
}

function draw() {
  background(240); // (change this out based on our final code)

  // if there are images in the array, show them
  if (selfieCapture.length > 0 ) {
    for (let i = 0; i < selfieCapture.length; i++) {
      //for loop to continue displaying images as they are saved to the array
      image(selfieCapture[i], 20 + 150 * i, 0, 130, 100); // creating an image based on each added array object and moving the position further right every time so they don't overlap
      
      if (selfieCapture.length >= 6){
        textSize(15);
        text("You're out of photos!", 50, 200); // only screen room for 6 photos, so if more than let people know they have to stop
      }
    }
  }
}
